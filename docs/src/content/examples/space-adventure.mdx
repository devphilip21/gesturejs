import { Code } from "astro:components";
import SpaceAdventure from "@/components/examples/space-adventure.astro";

# Space Adventure

An interactive space canvas where you can zoom in and out using pinch gestures, keyboard, or mouse wheel.

> **Note:** Multiple input sources are orchestrated into a consistent zoom behavior.

<SpaceAdventure />

## Code

```typescript
import { wheel, keydown, keyheld, dom, pinch } from "cereb";
import { zoom as createZoom, extend, when, spy } from "cereb/operators";

const zoomMode$ = keyheld(window, { code: "KeyZ" })
  .pipe(extend((signal) => ({ opened: signal.value.held })));

const zoom = (options = {}) => createZoom({
  minScale: MIN_SCALE,
  maxScale: MAX_SCALE,
  baseScale: () => zoomManager.getScale(),
  ...options
});

// Pinch Zoom - phase-based session management (baseScale captured at start)
pinch(box, { threshold: 10 })
  .pipe(
    extend((signal) => ({
      ratio: 1 + (signal.value.ratio - 1) * PINCH_SENSITIVITY,
    })),
    zoom(),
  )
  .on(render);

// 'z' + '+/-' - ratio as absolute scale (current × factor)
keydown(window, { code: ["Equal", "Minus"] })
  .pipe(
    when(zoomMode$),
    extend((signal) => ({
      ratio: zoomManager.getScale() * (signal.value.code === "Equal" ? 1.2 : 1 / 1.2),
    })),
    zoom({ baseScale: 1.0 }),
  )
  .on(render);

// 'z' + 'wheel' - ratio as absolute scale (current × factor)
wheel(box, { passive: false })
  .pipe(
    when(zoomMode$),
    spy((signal) => signal.value.originalEvent.preventDefault()),
    extend((signal) => ({
      ratio: zoomManager.getScale() * Math.exp(-signal.value.deltaY * 0.005),
    })),
    zoom({ baseScale: 1.0 }),
  )
  .on(render);
```
